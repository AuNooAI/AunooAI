<!DOCTYPE html>
<html>
<head>
    <title>Change Password - N0RN AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/login.css">
</head>
<body>
    <div class="container">
        <div class="login-container">
            <h2>Change Password</h2>
            {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
            {% endif %}
            <form method="post" id="change-password-form" onsubmit="return validateForm()">
                <div class="mb-3">
                    <label for="current_password" class="form-label">Current Password</label>
                    <input type="password" class="form-control" id="current_password" name="current_password" required>
                </div>
                <div class="mb-3">
                    <label for="new_password" class="form-label">New Password</label>
                    <input type="password" class="form-control" id="new_password" name="new_password" required>
                    <div id="password-requirements" class="mt-2">
                        <small class="text-muted">Password must contain:</small>
                        <ul class="list-unstyled">
                            <li><small id="length-check">❌ At least 8 characters</small></li>
                            <li><small id="uppercase-check">❌ One uppercase letter</small></li>
                            <li><small id="number-check">❌ One number</small></li>
                            <li><small id="special-check">❌ One special character</small></li>
                        </ul>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="confirm_password" class="form-label">Confirm New Password</label>
                    <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                    <div id="match-check" class="mt-2 d-none text-danger">
                        <small>❌ Passwords do not match</small>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary w-100">Change Password</button>
            </form>
        </div>
    </div>

    <script>
    function validatePassword(password) {
        return {
            length: password.length >= 8,
            uppercase: /[A-Z]/.test(password),
            number: /[0-9]/.test(password),
            special: /[!@#$%^&*(),.?":{}|<>]/.test(password)
        };
    }

    function updateRequirements(password) {
        const requirements = validatePassword(password);
        
        document.getElementById('length-check').innerHTML = 
            `${requirements.length ? '✅' : '❌'} At least 8 characters`;
        document.getElementById('uppercase-check').innerHTML = 
            `${requirements.uppercase ? '✅' : '❌'} One uppercase letter`;
        document.getElementById('number-check').innerHTML = 
            `${requirements.number ? '✅' : '❌'} One number`;
        document.getElementById('special-check').innerHTML = 
            `${requirements.special ? '✅' : '❌'} One special character`;

        return Object.values(requirements).every(Boolean);
    }

    function validateForm() {
        const newPassword = document.getElementById('new_password').value;
        const confirmPassword = document.getElementById('confirm_password').value;
        const matchCheck = document.getElementById('match-check');

        const passwordValid = updateRequirements(newPassword);
        const passwordsMatch = newPassword === confirmPassword;

        matchCheck.classList.toggle('d-none', passwordsMatch);
        
        return passwordValid && passwordsMatch;
    }

    // Add real-time validation for new password
    document.getElementById('new_password').addEventListener('input', function() {
        updateRequirements(this.value);
    });

    // Add real-time validation for password match
    document.getElementById('confirm_password').addEventListener('input', function() {
        const newPassword = document.getElementById('new_password').value;
        const matchCheck = document.getElementById('match-check');
        matchCheck.classList.toggle('d-none', this.value === newPassword);
    });
    </script>
</body>
</html> 